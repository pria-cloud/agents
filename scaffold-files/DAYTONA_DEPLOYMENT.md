# Daytona Deployment Guide

This guide explains how to deploy your scaffold application to Daytona using your API key: 

## What is Daytona?

Daytona is a cloud development environment platform that creates isolated "sandboxes" (development environments) from your code repositories. Unlike traditional snapshot systems, Daytona creates environments from git repositories and provides powerful APIs for managing them.

## Important: Daytona Uses Git Repositories, Not Snapshots

Daytona doesn't create "snapshots" in the traditional VM sense. Instead, it:
- Creates **sandboxes** from git repositories
- Uses **branches** for different versions
- Provides **development environment orchestration**

## Prerequisites

1. Your scaffold application must be in a git repository
2. The repository should be accessible (public or with proper credentials)
3. Python 3.7+ or Node.js 14+ installed locally

## Deployment Options

### Option 1: Automated Deployment Scripts

I've created two deployment scripts for you:

#### Python Script (`daytona-deploy.py`)

```bash
# Make the script executable
chmod +x daytona-deploy.py

# Deploy from current git repository
./daytona-deploy.py

# Deploy from specific git URL
./daytona-deploy.py https://github.com/yourusername/your-scaffold-repo.git
```

#### Node.js Script (`daytona-deploy.js`)

```bash
# Make the script executable
chmod +x daytona-deploy.js

# Deploy from current git repository
./daytona-deploy.js

# Deploy from specific git URL
./daytona-deploy.js https://github.com/yourusername/your-scaffold-repo.git
```

### Option 2: Manual Daytona CLI

If you prefer using Daytona's CLI directly:

```bash
# Install Daytona CLI
curl -Ls https://download.daytona.io/install.sh | bash

# Set your API key
export DAYTONA_API_KEY="dtn_9a351cb5107703f573434ff12e6571768fd8ad963188b40c8ec65cf0f173be63"

# Create a sandbox from your repository
daytona create https://github.com/yourusername/your-scaffold-repo.git
```

### Option 3: Daytona Dashboard

1. Go to [Daytona Dashboard](https://daytona.io/dashboard)
2. Sign in with your API key
3. Click "Create Sandbox"
4. Enter your git repository URL
5. Configure resources (2 CPU, 4GB RAM, 8GB disk recommended)
6. Click "Create"

## What the Deployment Scripts Do

1. **Install Daytona SDK** - Automatically installs the required SDK
2. **Create Sandbox** - Creates a new development environment with:
   - 2 CPU cores
   - 4GB RAM
   - 8GB disk space
   - Auto-stop disabled (runs indefinitely)
3. **Install Dependencies** - Runs `npm install`
4. **Build Application** - Runs `npm run build`
5. **Start Development Server** - Runs `npm run dev`

## Sandbox Configuration

The scripts create a sandbox with these specifications:

```javascript
{
  repository: "your-repo-url",
  branch: "main",
  autoStopInterval: 0, // Runs indefinitely
  resources: {
    cpu: 2,    // 2 CPU cores
    memory: 4, // 4GB RAM
    disk: 8,   // 8GB disk
  },
  labels: {
    project: "scaffold-app",
    type: "nextjs-development",
    "api-enabled": "true"
  }
}
```

## Your Scaffold Features in Daytona

Once deployed, your scaffold application in Daytona will have:

✅ **Hot Reload Development** - File changes trigger automatic reloads
✅ **API Endpoints** - All your custom APIs will be available
✅ **GitHub Import** - Use `/api/workspace/github` to import repos
✅ **File Manipulation** - Use `/api/workspace/files` for hot swapping
✅ **Health Monitoring** - Use `/api/health` for status checks
✅ **Webhook Support** - Use `/api/webhooks/external` for integrations

## Accessing Your Application

After deployment, you can access your application through:

1. **Daytona Preview URL** - Automatically generated by Daytona
2. **Port Forwarding** - Direct access to ports (3000 for Next.js)
3. **VS Code Integration** - Connect VS Code directly to the sandbox

## API Usage in Daytona

Your APIs will be accessible via the Daytona sandbox URL:

```javascript
// Example: Using the GitHub import API
const response = await fetch(`${DAYTONA_SANDBOX_URL}/api/workspace/github`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    url: 'https://github.com/vercel/next.js',
    targetPath: '/templates/nextjs'
  })
});
```

## Managing Your Sandbox

### Using Daytona SDK

```python
from daytona import Daytona

daytona = Daytona()

# List your sandboxes
sandboxes = daytona.list()

# Find your sandbox
sandbox = daytona.find_one("your-sandbox-id")

# Start/stop sandbox
sandbox.start()
sandbox.stop()

# Execute commands
result = sandbox.process.run("npm run build")
```

### Using CLI Commands

```bash
# List sandboxes
daytona sandbox list

# Start/stop sandbox
daytona sandbox start <sandbox-id>
daytona sandbox stop <sandbox-id>

# Connect to sandbox
daytona code <sandbox-id>
```

## Development Workflow

1. **Deploy Initial Version** - Use the deployment scripts
2. **Develop Locally** - Use hot reload APIs to sync changes
3. **Import Templates** - Use GitHub import API for quick setups
4. **Create Branches** - Use Daytona branches for different features
5. **Collaborate** - Share sandbox URLs with team members

## Troubleshooting

### Script Fails to Run
```bash
# Ensure you have proper permissions
chmod +x daytona-deploy.py
chmod +x daytona-deploy.js

# Check Python/Node.js versions
python3 --version
node --version
```

### Git Repository Issues
```bash
# Ensure you're in a git repository
git status

# Check remote URL
git remote get-url origin

# Ensure repository is accessible
git fetch origin
```

### API Key Issues
- Verify your API key is correct: `dtn_9a351cb5107703f573434ff12e6571768fd8ad963188b40c8ec65cf0f173be63`
- Check if the key has proper permissions
- Try accessing Daytona dashboard with the key

### Sandbox Resource Limits
- Check your Daytona account limits
- Verify you have sufficient resources allocated
- Consider reducing resource requirements if needed

## Alternative: Manual GitHub Repository Creation

If the automated scripts don't work, you can:

1. Push your scaffold files to a GitHub repository
2. Use the Daytona dashboard to create a sandbox from that repository
3. Manually run the build commands in the Daytona terminal

## Support

- **Daytona Documentation**: https://docs.daytona.io/
- **Daytona Community**: https://daytona.io/community
- **SDK Reference**: https://docs.daytona.io/sdk/

## Next Steps

After successful deployment:

1. Access your scaffold application via Daytona's preview URL
2. Test the hot reload APIs by making file changes
3. Try importing GitHub repositories using the import API
4. Set up CI/CD workflows to automatically deploy changes
5. Share your sandbox with team members for collaboration 